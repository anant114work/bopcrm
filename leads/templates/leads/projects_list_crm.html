{% extends 'leads/base_unified.html' %}

{% block title %}Projects - Meta Leads CRM{% endblock %}
{% block page_title %}Projects{% endblock %}



{% block content %}
<div class="card">
    <div class="card-header" class="d-flex">
        <h2><i class="fas fa-project-diagram"></i> Projects</h2>
        <a href="{% url 'project_create' %}" class="btn btn-primary">
            <i class="fas fa-plus"></i> Create Project
        </a>
    </div>
    <div class="card-content">
        <div class="gap-2">
            {% for project in projects %}
            <div class="card" class="mb-0">
                <div class="card-header" style="border-radius: 8px 8px 0 0;">
                    <h2 style="font-size: 16px;">{{ project.name }}</h2>
                </div>
                <div class="card-content">
                    <div style="margin-bottom: 16px;">
                        <div class="text-muted">
                            <i class="fas fa-building"></i> {{ project.developer }}
                        </div>
                        <div class="text-muted">
                            <i class="fas fa-map-marker-alt"></i> {{ project.location }}
                        </div>
                        <div class="text-muted">
                            <i class="fas fa-users"></i> {{ project.lead_count }} leads
                        </div>
                    </div>
                    
                    {% if project.description %}
                    <p class="text-muted">
                        {{ project.description|truncatechars:100 }}
                    </p>
                    {% endif %}
                    
                    <div class="d-flex">
                        <a href="/projects/{{ project.id }}/" class="btn btn-primary" class="small">
                            <i class="fas fa-eye"></i> View Details
                        </a>
                        <a href="/projects/{{ project.id }}/leads/" class="btn btn-secondary" class="small">
                            <i class="fas fa-list"></i> View Leads
                        </a>
                        <a href="/projects/{{ project.id }}/team-members/" class="btn btn-info" class="small">
                            <i class="fas fa-users"></i> Manage Team
                        </a>
                        <a href="/projects/{{ project.id }}/bulk-whatsapp/" class="btn" class="small">
                            <i class="fas fa-paper-plane"></i> Send WhatsApp
                        </a>
                        <button onclick="deleteProject({{ project.id }}, '{{ project.name|escapejs }}')" class="btn" class="small">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="text-center">
                <i class="fas fa-project-diagram" style="font-size: 48px; margin-bottom: 16px; display: block;"></i>
                No projects found
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
function deleteProject(projectId, projectName) {
    if (confirm(`Are you sure you want to delete project "${projectName}"? This action cannot be undone.`)) {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = `/projects/${projectId}/delete/`;
        document.body.appendChild(form);
        form.submit();
    }
}
{% endblock %}